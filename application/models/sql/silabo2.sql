
use educayso_facae;
drop view silabo2;
create view silabo2 as select sila.idsilabo,sila.idperiodoacademico,sila.nombre as elsilabo, peac.nombrecorto as elperiodo,asig.idasignatura, asig.nombre as laasignatura, sila.iddocente, concat(COALESCE(pers.apellidos,''),"  ",COALESCE(pers.nombres,''))  as eldocente,(select malla.nombrecorto from malla where malla.idmalla=asig.idmalla) as malla,sila.iddocumento, (select docu.asunto from documento docu where docu.iddocumento=sila.iddocumento) as asunto, (select docu.archivopdf from documento docu where docu.iddocumento=sila.iddocumento) as archivopdf, (select docu.archivopdf from documento docu, documentosilabo dosi where docu.iddocumento=dosi.iddocumento and dosi.idsilabo=sila.idsilabo limit 1 ) as elplandeclasepdf, (select docu.archivopdf from documento docu, documentosilabo dosi where docu.iddocumento=dosi.iddocumento and dosi.idsilabo=sila.idsilabo and dosi.idtipodocu=9 limit 1 ) as silabopdf, (select docu.archivopdf from documento docu, documentoevento doev where docu.iddocumento=doev.iddocumento and doev.idevento=even.idevento  and doev.idtipodocu=38 ) as planclasepdf , (select docu.archivopdf from documento docu, documentosilabo dosi where docu.iddocumento=dosi.iddocumento and dosi.idsilabo=sila.idsilabo and dosi.idtipodocu=46 limit 1 ) as proyectocursopdf, (select docu.archivopdf from documento docu, documentoevento doev where docu.iddocumento=doev.iddocumento and doev.idevento=even.idevento and doev.idtipodocu=47 limit 1 ) as reactivo1pdf,(select docu.archivopdf from documento docu, documentoevento doev where docu.iddocumento=doev.iddocumento and doev.idevento=even.idevento and doev.idtipodocu=56 limit 1 ) as reactivo2pdf,(select docu.archivopdf from documento docu, documentoevento doev where docu.iddocumento=doev.iddocumento and doev.idevento=even.idevento and doev.idtipodocu=40 limit 1 ) as calificacion1pdf,(select docu.archivopdf from documento docu, documentoevento doev where docu.iddocumento=doev.iddocumento and doev.idevento=even.idevento and doev.idtipodocu=57 limit 1 ) as calificacion2pdf, (select docu.archivopdf from documento docu, documentoevento doev where docu.iddocumento=doev.iddocumento and doev.idevento=even.idevento and doev.idtipodocu=51 limit 1 ) as informeactividadpdf , (select docu.archivopdf from documento docu, documentosilabo dosi where docu.iddocumento=dosi.iddocumento and dosi.idsilabo=sila.idsilabo and dosi.idtipodocu=21 limit 1 ) as distributivoindividualpdf,   even.idevento    from silabo sila,periodoacademico peac, asignatura asig, persona pers, docente doce, evento even  where sila.idperiodoacademico=peac.idperiodoacademico and sila.idasignatura=asig.idasignatura and sila.iddocente=doce.iddocente and doce.idpersona=pers.idpersona and sila.idsilabo=even.idsilabo;
