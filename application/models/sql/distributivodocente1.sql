use educayso_facae;
create view distributivodocente1 as select dido.iddistributivodocente,dido.iddocente, concat(COALESCE(pers.apellidos,''),"  ",COALESCE(pers.nombres,'')) as eldocente,pers.cedula,dido.portafoliodrive, dido.iddistributivo, peac.nombrecorto as elperiodoacademico, depa.iddepartamento,depa.nombre as eldepartamento, concat(COALESCE(depa.iniciales,'')," - ",COALESCE(peac.nombrecorto,'')," - ", COALESCE(pers.apellidos,''),"  ",COALESCE(pers.nombres,'')) as eldistributivodocente, (select count(asdo.idasignaturadocente) from asignaturadocente asdo where asdo.iddistributivodocente=dido.iddistributivodocente) as numeasig,peac.idperiodoacademico,(select round(sum(jodo.duracionminutos)/60,1) from jornadadocente jodo, asignaturadocente asdo where jodo.idasignaturadocente=asdo.idasignaturadocente and asdo.iddistributivodocente=dido.iddistributivodocente) as horas,  (select nombre from correo where correo.idpersona=pers.idpersona limit 1) as correo  , (select docu.archivopdf from  documento docu,documentoportafolio dopo, portafolio pofo  where docu.iddocumento=dopo.iddocumento and dopo.idportafolio=pofo.idportafolio and pofo.idperiodoacademico=peac.idperiodoacademico and pofo.idpersona=doce.idpersona and doce.iddocente=dido.iddocente and docu.idtipodocu=21 limit 1) as distributivoindividualpdf,  (select docu.archivopdf from  documento docu,documentoportafolio dopo, portafolio pofo  where docu.iddocumento=dopo.iddocumento and dopo.idportafolio=pofo.idportafolio and pofo.idperiodoacademico=peac.idperiodoacademico and pofo.idpersona=doce.idpersona and doce.iddocente=dido.iddocente and docu.idtipodocu=51 limit 1) as informeactividaddocente  from distributivodocente0 dido,distributivo dist, periodoacademico peac, docente doce, persona pers,departamento depa where dist.iddistributivo=dido.iddistributivo and dido.iddocente=doce.iddocente and doce.idpersona=pers.idpersona and dist.idperiodoacademico=peac.idperiodoacademico and dist.iddepartamento=depa.iddepartamento;
