use educayso_facae;
drop view participante1;
create view participante1 as select pa.idparticipante,pa.idevento,ev.titulo as elevento,pa.idpersona,concat(pe.apellidos," ",pe.nombres) as nombres,doc.archivopdf,pa.grupoletra,(select count(asis.idtipoasistencia) from asistencia asis where asis.idevento=pa.idevento and asis.idpersona=pa.idpersona and asis.idtipoasistencia=1) as puntual,(select count(asis.idtipoasistencia) from asistencia asis where asis.idevento=pa.idevento and asis.idpersona=pa.idpersona and asis.idtipoasistencia=2) as atrasado  from participante pa,persona pe,evento ev,documento doc where pa.idpersona=pe.idpersona and pa.idevento=ev.idevento and pa.iddocumento=doc.iddocumento
UNION 

select pa.idparticipante,pa.idevento,ev.titulo as elevento,pa.idpersona,concat(pe.apellidos," ",pe.nombres) as nombres," " as archivopdf,pa.grupoletra ,(select count(asis.idtipoasistencia) from asistencia asis where asis.idevento=pa.idevento and asis.idpersona=pa.idpersona and asis.idtipoasistencia=1) as puntual,(select count(asis.idtipoasistencia) from asistencia asis where asis.idevento=pa.idevento and asis.idpersona=pa.idpersona and asis.idtipoasistencia=2) as atrasado  from participante pa,persona pe,evento ev,documento doc where pa.idpersona=pe.idpersona and pa.idevento=ev.idevento and pa.iddocumento=0;
